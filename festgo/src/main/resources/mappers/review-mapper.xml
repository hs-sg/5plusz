<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.oplusz.festgo.repository.ReviewDao">



<!-- 희성 작성 시작 -->

    <!-- 로그인된 아이디로 작성된 글 목록 조회 -->
    <!-- <select id="readByMeUsername" resultType="Post">
        select *
		from post
		where po_author = #{meUsername}
    </select> -->
    
    <!-- 관리자용 전체글 목록 원하는 수대로 가져오기 -->
    <select id="readReviewVariableByPageNum" resultType="Review">
	    select re_id, re_title, re_content, re_author, re_created_time, re_modified_time, re_grade, fe_id from
	        (
		    select rownum rno, re_id, re_title, re_content, re_author, re_created_time, re_modified_time, re_grade, fe_id
		    from (select * from review order by re_created_time desc)
		    where re_id > 0 and rownum > 0 and rownum <![CDATA[<]]>= #{maxReviewNum}
	        )
	    where rno >= #{minReviewNum} and rno <![CDATA[<]]>= #{maxReviewNum}
    </select>
    
    <!-- 일반, 스폰서용 작성글 원하는 수대로 가져오기 -->
    <select id="readReviewVariableByMeUsername" resultType="Review">
        select re_id, re_title, re_content, re_author, re_created_time, re_modified_time, re_grade, fe_id from
            (
            select rownum rno, re_id, re_title, re_content, re_author, re_created_time, re_modified_time, re_grade, fe_id
            from (select * from review where re_author = #{meUsername} order by re_created_time desc)
            where re_id > 0 and rownum > 0 and rownum <![CDATA[<]]>= #{maxReviewNum}
            )
        where rno >= #{minReviewNum} and rno <![CDATA[<]]>= #{maxReviewNum}
    </select>
    
    <!-- 전체 글 갯수 세기 -->
    <select id="countAllReviews">
        select count(*) from review
    </select>
    
    <!-- 로그인한 아이디가 등록한 글 갯수 세기 -->
    <select id="countReviewsByMeUsername">
        select count(*) from review where re_author = #{meUsername}
    </select>
    
    <!-- 선택된 리뷰 삭제하기 -->
    <delete id="deleteReviewByReId">
        delete from review where re_id = #{reId}
    </delete>
    
<!-- 희성 작성 끝 -->

</mapper>
